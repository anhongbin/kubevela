apiVersion: core.oam.dev/v1alpha2
kind: TraitDefinition
metadata:
  name: metricstraits.standard.oam.dev
  namespace: default
  annotations:
    definition.oam.dev/apiVersion: standard.oam.dev/v1alpha1
    definition.oam.dev/kind: MetricsTrait
spec:
  appliesToWorkloads:
    - containerizedworkloads.core.oam.dev
    - clonesetworkloads.apps.kruise.io
    - deployments.apps
    - statefulsets.apps
  definitionRef:
    name: metricstraits.standard.oam.dev
  workloadRefPath: spec.workloadRef
  extension:
    template: |-
      #Template: {
      	apiVersion: "standard.oam.dev/v1alpha1"
      	kind:       "MetricsTrait"
      	spec: {
          scrapeService: {
            format?: scrapeSpec.format
            path?: scrapeSpec.path
            scheme?: scrapeSpec.scheme
            enabled?: scrapeSpec.enabled
            port?: scrapeSpec.port
            selector?:
          }
      	}
      }
      scrapeSpec: {
      	format?: *"/metrics" | string
        path?: *"/metrics" | string
        scheme?: *"http" | string
        enabled?: *true | bool
        port?: >=0 & <=65545 & int
      }